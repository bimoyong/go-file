syntax = "proto3";

package go.srv.file;

import "google/protobuf/timestamp.proto";

service File {
	rpc Upload(stream UploadReq) returns (UploadResp) {}
	rpc Download(DownloadReq) returns (stream DownloadResp) {}
}

message UploadReq {
	Chunk chunk = 1;
}

message UploadResp {
	string id = 1;
	google.protobuf.Timestamp timestamp = 2;
}

message DownloadReq {
	string id = 1;
}

message DownloadResp {
	Chunk chunk = 1;
	Description desc = 2;
	google.protobuf.Timestamp timestamp = 3;
}

message Chunk {
	bytes data = 1;
	string checksum = 2;
}

message Description {
	string id = 1;
	string ext = 2;
	int64 size = 3;
	google.protobuf.Timestamp created_at = 4;
}
